import{$ as j,B as D,F as R,G as y,H as v,M as F,N as z,S as B,U as N,W as A,X as H,Y as V,Z as L,_ as Y,a as h,aa as W,b as _,c as l,ca as U,d as g,da as q,e as C,f as x,fa as G,g as f,h as t,i as n,j as u,k as M,l as m,m as p,n as i,o as b,p as P,q as k,r as S,s as I,t as O,u as w,v as E,w as T}from"./chunk-2BK3DPR5.js";import"./chunk-Z27GUSSL.js";import"./chunk-7KGURMOZ.js";import"./chunk-RJYTLPPS.js";import"./chunk-VJIVQHDH.js";import"./chunk-ZKRXQTCG.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-IL4VJRLA.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function K(a,c){if(a&1){let s=M();t(0,"div",18)(1,"div",19)(2,"label",20),i(3,"Selecciona mes y a\xF1o"),n(),t(4,"ion-datetime",21),S("ngModelChange",function(e){h(s);let o=p();return k(o.selectedDate,e)||(o.selectedDate=e),_(e)}),n(),t(5,"ion-button",22),m("click",function(){h(s);let e=p();return _(e.fetchRecordsByDate())}),i(6," Buscar registros "),n()()()}if(a&2){let s=p();l(4),f("presentation","month-year"),P("ngModel",s.selectedDate)}}function Q(a,c){if(a&1&&(t(0,"ion-item",23)(1,"ion-label",24),i(2),n(),t(3,"ion-label",24),i(4),n(),t(5,"ion-label",24),i(6),n()()),a&2){let s=c.$implicit;l(2),b(s.numero),l(2),b(s.horaRegistro||"Sin hora"),l(2),b(s.fechaRegistro||"Sin fecha")}}var re=(()=>{let c=class c{constructor(r,e,o){this.router=r,this.http=e,this.cdRef=o,this.turistas=[],this.showDateTime=!1,this.selectedDate=""}ngOnInit(){this.getTuristas()}toggleDateTime(){this.showDateTime=!this.showDateTime}fetchRecordsByDate(){if(!this.selectedDate){console.error("No se ha seleccionado una fecha");return}let r=new Date(this.selectedDate).toISOString().split("T")[0].slice(0,7);console.log("Fecha seleccionada y formateada (YYYY-MM):",r),this.http.get(`https://turistas.onrender.com/turistas/filtrar_fecha_presa?fecha=${r}`).subscribe(e=>{console.log("Datos filtrados:",e),this.turistas=e.map((o,d)=>({numero:d+1,horaRegistro:o.hora,fechaRegistro:o.fecha})),this.cdRef.detectChanges()},e=>{console.error("Error al filtrar turistas por fecha",e)})}getTuristas(r){this.http.get("https://turistas.onrender.com/turistas/presa").subscribe(e=>{console.log("Datos recibidos de la API:",e),this.turistas=e.map((o,d)=>({numero:d+1,horaRegistro:o.hora,fechaRegistro:o.fecha})),this.cdRef.detectChanges(),r&&r.target.complete()},e=>{console.error("Error al obtener los turistas",e),r&&r.target.complete()})}irAlugares(){this.router.navigate(["lugares"])}};c.\u0275fac=function(e){return new(e||c)(g(D),g(T),g(I))},c.\u0275cmp=C({type:c,selectors:[["app-presa"]],decls:42,vars:4,consts:[["contentId","main-content"],["slot","start"],[1,"ion-padding"],["button","",1,"menuboton",3,"click"],[3,"translucent"],["id","main-content",3,"fullscreen"],[1,"botonbuscar"],[3,"click"],["class","date-card",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Desliza para actualizar","refreshingSpinner","circles"],["collapse","condense"],["size","large"],[1,"custom-text-center"],[1,"registro-table"],[1,"table-header"],[1,"column-header"],["class","table-row",4,"ngFor","ngForOf"],[1,"date-card"],[1,"date-card-content"],[1,"date-label"],[1,"date-picker",3,"ngModelChange","presentation","ngModel"],[1,"buscar-fecha-button",3,"click"],[1,"table-row"],[1,"column-data"]],template:function(e,o){e&1&&(t(0,"ion-menu",0)(1,"ion-header")(2,"ion-buttons",1),u(3,"ion-menu-button"),n(),t(4,"ion-toolbar")(5,"ion-title"),i(6,"Men\xFA de Opciones"),n()()(),t(7,"ion-content",2),u(8,"br"),t(9,"ion-item",3),m("click",function(){return o.irAlugares()}),i(10,"Cerrar Sesi\xF3n"),n()()(),t(11,"ion-header",4)(12,"ion-toolbar")(13,"ion-title"),i(14,"Presa de Malpaso"),n()()(),t(15,"ion-content",5)(16,"ion-item",6)(17,"ion-button",7),m("click",function(){return o.toggleDateTime()}),i(18,"Buscar por fecha"),n()(),x(19,K,7,2,"div",8),t(20,"ion-refresher",9),m("ionRefresh",function(J){return o.getTuristas(J)}),u(21,"ion-refresher-content",10),n(),t(22,"ion-header",11)(23,"ion-toolbar")(24,"ion-title",12),i(25,"Presa de Malpaso"),n()()(),t(26,"div",13)(27,"ion-label")(28,"strong"),i(29,"Historial de Registros"),n()()(),t(30,"ion-list",14)(31,"ion-item",15)(32,"ion-label",16)(33,"strong"),i(34,"N\xFAmero"),n()(),t(35,"ion-label",16)(36,"strong"),i(37,"Hora de Registro"),n()(),t(38,"ion-label",16)(39,"strong"),i(40,"Fecha de Registro"),n()()(),x(41,Q,7,3,"ion-item",17),n()()),e&2&&(l(11),f("translucent",!0),l(4),f("fullscreen",!0),l(4),f("ngIf",o.showDateTime),l(22),f("ngForOf",o.turistas))},dependencies:[z,F,A,B,N,U,q,E,O,w,v,R,y,L,Y,H,V,j,W,G],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{--background-color: #ffffff;background-color:#fff!important}ion-content[_ngcontent-%COMP%]{--ion-background-color: #ffffff;background-color:#fff!important}ion-header[_ngcontent-%COMP%]{--background: #ffffff;background-color:#fff!important}ion-toolbar[_ngcontent-%COMP%]{--background: #041e68;background-color:#041e68!important;color:#fff}ion-title[_ngcontent-%COMP%]{text-align:center;font-size:20px}.menuboton[_ngcontent-%COMP%]{--background: #bf0b5b;background-color:#bf0b5b!important;color:#fff;border-radius:10px;text-align:center;padding:10px}.registro-table[_ngcontent-%COMP%]{--background-color: #f5f5f5 !important;--background: #ffffff !important;border-radius:25px;margin:5%}.table-header[_ngcontent-%COMP%]{--background: #dfdfdf;background-color:#dfdfdf!important;color:#bf0b5b;font-weight:700}.table-row[_ngcontent-%COMP%]{--background: #dfdfdf;background-color:#dfdfdf!important;color:#041e68}.column-header[_ngcontent-%COMP%], .column-data[_ngcontent-%COMP%]{text-align:center}ion-refresher-content[_ngcontent-%COMP%]{--background: transparent;--color: #041e68;color:#041e68;text-align:center}ion-refresher[_ngcontent-%COMP%]{z-index:10}ion-list[_ngcontent-%COMP%]{--background: #dfdfdf;background-color:#dfdfdf!important}.botonbuscar[_ngcontent-%COMP%]{--background: #ffffff;background-color:#dfdfdf!important}.custom-text-center[_ngcontent-%COMP%]{--background: #ffffff;background-color:#fff!important;color:#edce5a;text-align:center;font-size:25px}ion-button[_ngcontent-%COMP%]{--background: #bf0b5b;color:#fff}.date-card[_ngcontent-%COMP%]{margin:20px auto;padding:16px;max-width:350px;border-radius:12px;background-color:#dfdfdf;border:1px solid #ccc}.date-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px}.date-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#041e68;text-align:center}ion-datetime.date-picker[_ngcontent-%COMP%]{--background: #ffffff;border:1px solid #bf0b5b;border-radius:10px;padding:6px;width:100%;max-width:280px;font-size:14px;color:#041e68;background-color:#fff}.buscar-fecha-button[_ngcontent-%COMP%]{--background: #bf0b5b;--color: white;width:100%;max-width:200px;font-size:14px;font-weight:500;border-radius:8px}']});let a=c;return a})();export{re as PresaPage};
